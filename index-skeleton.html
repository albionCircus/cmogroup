<!DOCTYPE html>
<html>
<head>
  <title>Todo App with Search</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Include Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <main class="container mt-5">
        <h1 class="text-center mb-4">Todo App</h1>
        <!-- Search Input -->
        <section class="row mb-3">
            <div class="col-md-6 offset-md-3">
                <input type="text" id="searchInput" aria-label="Enter a search term" class="form-control" placeholder="Search by title...">
            </div>
        </section>
        <!-- Any bonus points for a loading spinner? (: -->
        <div id="loading" class="text-center my-3">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
        <!-- Todo Table -->
        <table id="dataTable" class="table table-striped table-hover d-none">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Completed</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </main>

  <!-- Include jQuery and Bootstrap JS -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    $(document).ready(function () {
      const $tbody = $('#dataTable tbody');
      let allTodos = [];

      // Fetch data from API
      $.ajax({
        url: 'https://jsonplaceholder.typicode.com/todos',
        method: 'GET',
        success: function (todos) {
          allTodos = todos; // Save for filtering
          renderRows(todos);

          $('#loading').hide();
          $('#dataTable').removeClass('d-none');
        },
        error: function () {
          $('#loading').html('<p class="text-danger">Failed to fetch todo items.</p>');
        }
      });

      // Render table rows
      function renderRows(todos) {
        $tbody.empty();
        todos.forEach(todo => {
          const completedBadge = todo.completed 
            ? '<span class="badge bg-success">Yes</span>' 
            : '<span class="badge bg-secondary">No</span>';
          const row = `
            <tr>
              <td>${todo.id}</td>
              <td class="todo-title">${todo.title}</td>
              <td>${completedBadge}</td>
            </tr>
          `;
          $tbody.append(row);
        });
      }

      // Search functionality
      $('#searchInput').on('keyup', function () {
        const searchText = $(this).val().toLowerCase();
        const filtered = allTodos.filter(todo => 
          todo.title.toLowerCase().includes(searchText)
        );
        renderRows(filtered);
      });
    });
  </script>
</body>
</html>
